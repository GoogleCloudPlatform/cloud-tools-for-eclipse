<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
  <!-- Migration from older versions of Cloud Tools for Eclipse -->
   <extension
         point="org.eclipse.ui.startup">
      <startup
            class="com.google.cloud.tools.eclipse.appengine.compat.cte13.CloudToolsEclipseProjectNotifier">
      </startup>
   </extension>
   <extension
        point="org.eclipse.core.expressions.propertyTesters">
     <propertyTester
           class="com.google.cloud.tools.eclipse.appengine.compat.cte13.RequiresUpdatePropertyTester"
           id="com.google.cloud.tools.eclipse.appengine.compat.requiresCteUpdate"
           namespace="com.google.cloud.tools.eclipse.appengine.compat.cte13"
           properties="requiresUpdate"
           type="org.eclipse.core.resources.IProject">
     </propertyTester>
  </extension>
  <extension
        point="org.eclipse.ui.commands">
     <command
           id="com.google.cloud.tools.eclipse.appengine.compat.cte13.updateProject"
           name="Update Project for Cloud Tools for Eclipse">
     </command>
  </extension>
  <extension
        point="org.eclipse.ui.handlers">
     <handler
           class="com.google.cloud.tools.eclipse.appengine.compat.cte13.UpdateCloudToolsEclipseProjectHandler"
           commandId="com.google.cloud.tools.eclipse.appengine.compat.cte13.updateProject">
        <enabledWhen>
        <and>
          <count value="1" />  <!-- enabled when exactly one project is selected -->
          <iterate>
            <adapt type="org.eclipse.core.resources.IProject">
              <test property="com.google.cloud.tools.eclipse.appengine.compat.cte13.requiresUpdate" />
            </adapt>
          </iterate>
        </and>
        </enabledWhen>
     </handler>
  </extension>
  <extension
        point="org.eclipse.ui.menus">
     <menuContribution
           allPopups="false"
           locationURI="popup:org.eclipse.ui.projectConfigure?after=additions">
        <command
              commandId="com.google.cloud.tools.eclipse.appengine.compat.cte13.updateProject"
              style="push">
           <visibleWhen
                 checkEnabled="true">
           </visibleWhen>
        </command>
     </menuContribution>
  </extension>

</plugin>
